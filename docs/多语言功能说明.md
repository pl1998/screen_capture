# 多语言功能实现说明

## ✅ 已完成的多语言功能

### 1. 语言文件结构

创建了完整的 i18n 国际化系统：

```
src/i18n/
├── i18n.js          # i18n 管理器
├── zh-CN.js         # 中文语言包
└── en-US.js         # 英文语言包
```

### 2. 支持的语言

- **简体中文 (zh-CN)** - 默认语言
- **English (en-US)** - 英语

### 3. 语言包内容

每个语言包包含以下翻译：

#### 应用标题
- 窗口标题

#### 状态文本
- 就绪 / Ready
- 录制中 / Recording
- 已暂停 / Paused
- 处理视频中 / Processing video
- 错误 / Error
- 已选择区域 / Area selected

#### 按钮文本
- 选择区域 / Select Area
- 开始 / Start
- 暂停 / Pause
- 恢复 / Resume
- 停止 / Stop
- 浏览 / Browse

#### 设置标签
- 设置 / Settings
- 分辨率 / Resolution
- 音频录制 / Audio Recording
- 输出目录 / Output Directory
- 语言 / Language

#### 选择器界面
- 标题和提示文本
- 坐标和尺寸显示
- 错误提示

#### 消息提示
- 录制保存成功
- 录制错误
- 未知错误

### 4. 实现的功能

#### 语言切换
- 在设置部分添加了语言选择下拉菜单
- 支持实时切换语言
- 切换后立即更新所有界面文本
- 语言偏好自动保存

#### 自动加载
- 应用启动时自动加载用户上次选择的语言
- 如果没有保存的语言设置，默认使用中文

#### 动态更新
- 所有界面元素使用 `data-i18n` 属性标记
- 语言切换时自动更新所有标记的元素
- 支持参数插值（如显示宽度、高度等动态值）

### 5. 技术实现

#### i18n 管理器 (i18n.js)
```javascript
class I18n {
  - registerLocale()  // 注册语言包
  - setLocale()       // 设置当前语言
  - getLocale()       // 获取当前语言
  - t()               // 获取翻译文本
  - interpolate()     // 参数插值
}
```

#### 主要特性
- **键路径访问**: 使用点号分隔的键访问嵌套翻译（如 `status.ready`）
- **参数插值**: 支持 `{param}` 格式的参数替换
- **备用语言**: 如果当前语言缺少翻译，自动使用英文
- **类型安全**: 如果找不到翻译，返回键本身作为备用

### 6. 使用方法

#### 在 HTML 中标记文本
```html
<h1 data-i18n="appTitle">屏幕录制工具</h1>
<button data-i18n="buttons.start">开始</button>
```

#### 在 JavaScript 中使用
```javascript
// 简单翻译
i18n.t('status.ready')  // "就绪" 或 "Ready"

// 带参数的翻译
i18n.t('status.areaSelected', {
  width: 800,
  height: 600
})  // "已选择区域: 800x600"

// 切换语言
i18n.setLocale('en-US')
updateUIText()  // 更新所有界面文本
```

### 7. 文件修改列表

#### 新增文件
1. `src/i18n/i18n.js` - i18n 管理器
2. `src/i18n/zh-CN.js` - 中文语言包
3. `src/i18n/en-US.js` - 英文语言包

#### 修改文件
1. `src/index.html` - 添加语言选择器和 i18n 标记
2. `src/renderer.js` - 集成 i18n 系统
3. `src/selector/selector.html` - 添加 i18n 标记
4. `src/selector/selector.js` - 集成 i18n 系统

### 8. 语言切换流程

1. 用户在设置中选择语言
2. 触发 `languageSelect` 的 `change` 事件
3. 调用 `i18n.setLocale(newLanguage)` 设置新语言
4. 调用 `saveCurrentSettings()` 保存语言偏好
5. 调用 `updateUIText()` 更新所有界面文本
6. 所有带 `data-i18n` 属性的元素自动更新

### 9. 测试方法

#### 测试语言切换
1. 启动应用：`npm start`
2. 在设置部分找到"语言"选项
3. 切换到 "English"
4. 观察所有按钮和文本是否变为英文
5. 切换回"简体中文"
6. 观察所有按钮和文本是否变回中文

#### 测试语言持久化
1. 选择一种语言
2. 关闭应用
3. 重新启动应用
4. 检查是否保持上次选择的语言

#### 测试选择器界面
1. 点击"选择区域"按钮
2. 检查顶部提示文本是否使用正确的语言
3. 拖动鼠标查看坐标显示
4. 尝试选择小于 100x100 的区域，查看错误提示语言

### 10. 扩展新语言

如果需要添加新语言（如日语、韩语等）：

1. 创建新的语言文件（如 `src/i18n/ja-JP.js`）
2. 复制 `en-US.js` 的结构
3. 翻译所有文本
4. 在 HTML 中引入新语言文件
5. 在 `renderer.js` 和 `selector.js` 中注册新语言
6. 在语言选择器中添加新选项

示例：
```javascript
// ja-JP.js
const jaJP = {
  appTitle: 'スクリーンレコーダー',
  // ... 其他翻译
};

// 在 renderer.js 中
i18n.registerLocale('ja-JP', jaJP);

// 在 HTML 中
<option value="ja-JP">日本語</option>
```

### 11. 注意事项

#### 已实现
- ✅ 主窗口完整多语言支持
- ✅ 选择器窗口完整多语言支持
- ✅ 语言偏好持久化
- ✅ 实时语言切换
- ✅ 参数插值支持
- ✅ 备用语言机制

#### 限制
- 语言文件需要手动维护
- 新增界面文本需要同时更新所有语言文件
- 某些系统消息（如文件对话框）使用系统语言

### 12. 性能优化

- 语言包在页面加载时一次性加载
- 切换语言时只更新 DOM，不重新加载文件
- 使用缓存避免重复查找翻译

---

## 🎉 功能完成

多语言功能已完全实现并可以使用！

**实现日期**: 2024-02-06
**支持语言**: 中文、英文
**状态**: ✅ 完成并可用
