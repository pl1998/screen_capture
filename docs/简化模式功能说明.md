# 简化模式功能说明

## 功能概述

简化模式是一个界面简化功能，可以将应用窗口缩小为垂直侧边栏样式，只显示核心控制按钮，适合在录制时保持界面简洁。

## 设计参考

基于 `docs/侧边栏.png` 设计图实现。

## 功能特性

### 1. 手动切换

**菜单路径**: 视图 → 简化模式

用户可以通过菜单栏的"视图"菜单中的"简化模式"选项手动切换界面模式。

### 2. 自动切换

**录制时自动简化**:
- 点击"开始"按钮开始录制时，界面自动切换到简化模式
- 录制过程中保持简化模式

**停止时自动恢复**:
- 点击"停止"按钮结束录制时，界面自动恢复到正常模式
- 恢复后显示完整的设置和状态信息

## 界面对比

### 正常模式
- **窗口尺寸**: 420 x 600 像素
- **布局**: 2x2 按钮网格
- **显示内容**:
  - ✅ 状态卡片（状态指示器 + 计时器）
  - ✅ 控制按钮（2x2 网格）
  - ✅ 设置区域（分辨率、音频）
  - ✅ 版本信息

### 简化模式
- **窗口尺寸**: 120 x 600 像素
- **布局**: 垂直单列
- **显示内容**:
  - ❌ 状态卡片（隐藏）
  - ✅ 控制按钮（垂直排列）
  - ❌ 设置区域（隐藏）
  - ❌ 版本信息（隐藏）

## 按钮样式

### 正常模式按钮
- 水平布局（图标 + 文字）
- 2x2 网格排列
- 尺寸: 标准按钮大小

### 简化模式按钮
- 垂直布局（图标在上，文字在下）
- 单列垂直排列
- 尺寸: 最小高度 80px
- 图标: 24x24 像素
- 文字: 13px 字体

## 技术实现

### 1. 窗口大小调整

**main.js - toggleCompactMode()**:
```javascript
if (isCompactMode) {
  mainWindow.setSize(120, 600);  // 简化模式
} else {
  mainWindow.setSize(420, 600);  // 正常模式
}
```

### 2. CSS 样式切换

**styles.css**:
```css
/* 简化模式容器 */
.container.compact-mode {
  padding: 12px 8px;
}

/* 隐藏非必要元素 */
.container.compact-mode .status-card,
.container.compact-mode .settings-section,
.container.compact-mode footer {
  display: none;
}

/* 按钮垂直布局 */
.container.compact-mode .controls {
  grid-template-columns: 1fr;
  gap: 8px;
}

.container.compact-mode .btn {
  flex-direction: column;
  padding: 16px 12px;
  gap: 6px;
  min-height: 80px;
}
```

### 3. IPC 通信

**主进程 → 渲染进程**:
- `compact-mode-changed`: 通知渲染进程模式已切换

**渲染进程响应**:
```javascript
window.electronAPI.onCompactModeChanged((isCompact) => {
  if (isCompact) {
    appContainer.classList.add('compact-mode');
  } else {
    appContainer.classList.remove('compact-mode');
  }
});
```

### 4. 自动切换逻辑

**开始录制时**:
```javascript
ipcMain.handle('start-recording', async (event, bounds) => {
  // ... 录制逻辑

  // 自动切换到简化模式
  if (!isCompactMode) {
    toggleCompactMode();
  }
});
```

**停止录制时**:
```javascript
ipcMain.handle('stop-recording', async () => {
  // ... 停止逻辑

  // 恢复正常模式
  if (isCompactMode) {
    toggleCompactMode();
  }
});
```

## 多语言支持

### 中文 (zh-CN)
```javascript
view: {
  compactMode: '简化模式'
}
```

### 英文 (en-US)
```javascript
view: {
  compactMode: 'Compact Mode'
}
```

## 使用场景

### 1. 录制时保持简洁
录制屏幕时，简化模式可以最小化应用窗口占用的屏幕空间，避免遮挡录制内容。

### 2. 侧边栏使用
将应用窗口放置在屏幕边缘，作为快速控制面板使用。

### 3. 多显示器环境
在多显示器环境中，可以将简化模式窗口放在副显示器上，方便控制录制。

## 文件变更清单

### 修改的文件
1. **menu-i18n.js** - 添加简化模式菜单项翻译
2. **main.js** - 添加简化模式切换逻辑和自动切换
3. **preload.js** - 添加简化模式 IPC 通信
4. **src/index.html** - 添加容器 ID
5. **src/styles.css** - 添加简化模式样式
6. **src/renderer.js** - 添加简化模式切换响应

### 新增的文件
- **docs/简化模式功能说明.md** - 本文档

## 测试建议

### 功能测试
1. ✅ 手动切换简化模式（菜单 → 视图 → 简化模式）
2. ✅ 开始录制时自动切换到简化模式
3. ✅ 停止录制时自动恢复正常模式
4. ✅ 简化模式下所有按钮功能正常
5. ✅ 多语言环境下菜单项正确显示

### 视觉测试
1. ✅ 窗口尺寸正确调整（120px vs 420px）
2. ✅ 按钮垂直排列正确
3. ✅ 图标和文字垂直居中
4. ✅ 状态卡片和设置正确隐藏/显示

### 边界测试
1. ✅ 快速切换模式不会出错
2. ✅ 录制过程中手动切换模式
3. ✅ 暂停状态下切换模式

## 已知限制

1. **窗口位置**: 切换模式时窗口位置可能需要手动调整
2. **动画效果**: 当前没有平滑的过渡动画
3. **记忆功能**: 不会记住用户的模式偏好（每次启动都是正常模式）

## 未来改进

1. **记忆模式**: 保存用户的模式偏好到设置
2. **过渡动画**: 添加窗口大小变化的平滑动画
3. **自定义宽度**: 允许用户自定义简化模式的窗口宽度
4. **快捷键**: 添加键盘快捷键快速切换模式

---

**实现日期**: 2026-02-06
**版本**: 1.0
**基于**: docs/侧边栏.png 设计图
