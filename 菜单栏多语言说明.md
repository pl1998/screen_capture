# 菜单栏多语言功能说明

## ✅ 已完成的功能

### 1. 菜单栏多语言支持

已将语言设置从界面移至菜单栏，并实现了完整的菜单多语言功能。

### 2. 菜单结构

#### macOS 菜单
- **应用菜单** (仅 macOS)
  - 关于 屏幕录制工具 / About Screen Recorder
  - 隐藏/显示选项
  - 退出应用

#### 所有平台菜单
- **文件菜单**
  - 选择区域 (Cmd/Ctrl+S)
  - 打开输出文件夹
  - 退出 (仅 Windows/Linux)

- **编辑菜单**
  - 撤销/重做
  - 剪切/复制/粘贴
  - 全选

- **语言菜单** ⭐ 新增
  - 简体中文 (单选)
  - English (单选)

- **窗口菜单**
  - 最小化
  - 关闭
  - 前置全部窗口 (仅 macOS)

### 3. 实现的功能

#### 语言切换
- ✅ 从菜单栏选择语言
- ✅ 使用单选按钮显示当前语言
- ✅ 切换后立即更新所有菜单文本
- ✅ 切换后通知渲染进程更新界面
- ✅ 语言偏好自动保存

#### 菜单快捷键
- **Cmd/Ctrl+S**: 选择录制区域
- 标准编辑快捷键 (Cmd/Ctrl+Z, X, C, V, A)

#### 菜单操作
- **选择区域**: 触发区域选择功能
- **打开输出文件夹**: 在文件管理器中打开视频保存目录

### 4. 技术实现

#### 新增文件
- `menu-i18n.js` - 菜单多语言配置文件

#### 修改文件
1. **main.js**
   - 导入 Menu 和 shell 模块
   - 添加 `createMenu()` 函数
   - 添加 `changeLanguage()` 函数
   - 在应用启动时创建菜单
   - 实现菜单和渲染进程的通信

2. **preload.js**
   - 添加 `onLanguageChanged` 监听器
   - 添加 `onMenuSelectArea` 监听器

3. **renderer.js**
   - 移除界面上的语言选择器代码
   - 添加菜单语言切换监听
   - 添加菜单操作监听

4. **index.html**
   - 移除语言选择器 UI 元素

### 5. 菜单配置结构

```javascript
menuI18n = {
  'zh-CN': {
    app: { ... },      // 应用菜单
    file: { ... },     // 文件菜单
    edit: { ... },     // 编辑菜单
    view: { ... },     // 视图菜单
    language: { ... }, // 语言菜单
    window: { ... },   // 窗口菜单
    help: { ... }      // 帮助菜单
  },
  'en-US': { ... }
}
```

### 6. 语言切换流程

```
用户点击菜单 → 语言菜单 → 选择语言
    ↓
changeLanguage() 函数
    ↓
1. 更新 currentLanguage 变量
2. 保存到设置文件
3. 重新创建菜单 (createMenu)
4. 发送 IPC 消息到渲染进程
    ↓
渲染进程接收 language-changed 事件
    ↓
1. 更新 i18n 语言
2. 调用 updateUIText()
3. 更新所有界面文本
```

### 7. 隐藏的菜单

为了简化界面，以下菜单已被隐藏或简化：

#### 完全隐藏
- ❌ 视图菜单 (开发者工具、缩放等)
- ❌ 帮助菜单 (文档、更新检查等)

#### 简化保留
- ✅ 文件菜单 (仅保留核心功能)
- ✅ 编辑菜单 (保留标准编辑操作)
- ✅ 窗口菜单 (保留基本窗口操作)

### 8. 平台差异

#### macOS
- 有独立的应用菜单
- 退出选项在应用菜单中
- 有"前置全部窗口"选项

#### Windows/Linux
- 没有应用菜单
- 退出选项在文件菜单中
- 没有"前置全部窗口"选项

### 9. 使用方法

#### 切换语言
1. 点击菜单栏的"语言" / "Language"
2. 选择"简体中文"或"English"
3. 界面和菜单立即切换语言

#### 使用快捷键
- **Cmd/Ctrl+S**: 快速打开区域选择器
- **Cmd/Ctrl+Z**: 撤销
- **Cmd/Ctrl+C**: 复制
- **Cmd/Ctrl+V**: 粘贴

#### 打开输出文件夹
1. 点击"文件" → "打开输出文件夹"
2. 系统文件管理器会打开视频保存目录

### 10. 测试方法

#### 测试菜单语言切换
1. 启动应用: `npm start`
2. 查看菜单栏，应该显示中文菜单
3. 点击"语言" → "English"
4. 观察所有菜单文本变为英文
5. 界面文本也同时变为英文
6. 切换回"简体中文"，确认恢复中文

#### 测试菜单操作
1. 点击"文件" → "选择区域"
2. 确认区域选择器打开
3. 或使用快捷键 Cmd/Ctrl+S
4. 点击"文件" → "打开输出文件夹"
5. 确认文件管理器打开正确目录

#### 测试语言持久化
1. 切换到英文
2. 关闭应用
3. 重新启动
4. 确认菜单和界面都保持英文

### 11. 优势

#### 用户体验
- ✅ 符合桌面应用习惯
- ✅ 节省界面空间
- ✅ 快捷键支持
- ✅ 原生菜单外观

#### 技术优势
- ✅ 使用 Electron 原生菜单 API
- ✅ 跨平台一致性
- ✅ 系统级集成
- ✅ 易于扩展

### 12. 扩展指南

#### 添加新菜单项
1. 在 `menu-i18n.js` 中添加翻译
2. 在 `createMenu()` 中添加菜单项
3. 实现对应的功能

#### 添加新语言
1. 在 `menu-i18n.js` 中添加新语言配置
2. 在语言菜单中添加新选项
3. 更新 `src/i18n/` 中的语言文件

### 13. 注意事项

#### 已知限制
- 菜单文本在切换语言后立即更新
- 某些系统菜单项（如"服务"）使用系统语言
- 快捷键在所有语言中保持一致

#### 最佳实践
- 菜单文本应简洁明了
- 快捷键应符合平台习惯
- 重要功能应有快捷键

---

## 🎉 功能完成

菜单栏多语言功能已完全实现！

**实现日期**: 2024-02-06
**支持平台**: macOS, Windows, Linux
**支持语言**: 中文、英文
**状态**: ✅ 完成并可用

## 📝 文件清单

### 新增文件
- `menu-i18n.js` - 菜单多语言配置

### 修改文件
- `main.js` - 添加菜单创建和语言切换
- `preload.js` - 添加菜单相关 IPC
- `src/renderer.js` - 移除界面语言选择器
- `src/index.html` - 移除语言选择器 UI

## 🚀 测试

运行应用测试菜单功能：
```bash
npm start
```

查看菜单栏，尝试切换语言和使用菜单功能！
