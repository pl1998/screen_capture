# 透明标题栏实现说明

## 功能概述

实现了透明标题栏效果，使应用的渐变背景延伸到标题栏区域，与UI设计图保持一致。

## 实现方案

采用**方案1：透明标题栏**，保留系统原生的窗口控制功能，同时让背景透明。

## 技术实现

### 1. 窗口配置 (main.js)

```javascript
function createMainWindow() {
  const isMac = process.platform === 'darwin';

  mainWindow = new BrowserWindow({
    width: 420,
    height: 680,
    resizable: false,
    transparent: true,                    // 启用透明窗口
    backgroundColor: '#00000000',         // 完全透明背景
    titleBarStyle: isMac ? 'hiddenInset' : 'default',  // macOS隐藏标题栏
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: true,
      preload: path.join(__dirname, 'preload.js')
    }
  });
}
```

**关键配置**:
- `transparent: true` - 启用透明窗口
- `backgroundColor: '#00000000'` - 设置完全透明的背景色
- `titleBarStyle: 'hiddenInset'` - macOS上隐藏标题栏但保留窗口控制按钮

### 2. CSS 样式调整

#### Body 样式
```css
body {
  background: transparent;
  -webkit-app-region: drag;  /* 允许拖拽窗口 */
}
```

#### 容器样式
```css
.container {
  padding-top: 40px;  /* 为macOS标题栏留出空间 */
  -webkit-app-region: no-drag;  /* 容器内容可交互 */
}
```

#### 交互元素
```css
button, select, input, a {
  -webkit-app-region: no-drag;  /* 确保可点击 */
}
```

## 平台差异

### macOS
- 使用 `titleBarStyle: 'hiddenInset'`
- 标题栏完全透明
- 保留红黄绿交通灯按钮
- 窗口可通过任意区域拖拽（除交互元素外）

### Windows/Linux
- 使用 `titleBarStyle: 'default'`
- 保留系统默认标题栏
- 背景透明效果可能受系统主题影响

## 视觉效果

### 之前
- 标题栏：白色/深色（跟随系统主题）
- 内容区：渐变背景
- 明显的分界线

### 之后
- 标题栏：透明，显示渐变背景
- 内容区：渐变背景
- 无缝融合，视觉统一

## 窗口拖拽

### 可拖拽区域
- Body 区域（背景）
- 非交互元素区域

### 不可拖拽区域（可交互）
- 按钮
- 下拉选择器
- 输入框
- 链接

## 兼容性

### 支持的平台
- ✅ macOS 10.10+
- ✅ Windows 10+
- ✅ Linux (效果可能因桌面环境而异)

### 浏览器内核
- ✅ Chromium (Electron 内置)

## 已知问题

### macOS
- 在某些情况下，窗口阴影可能显示异常
- 全屏模式下可能需要特殊处理

### Windows
- 透明效果可能受 Aero/DWM 影响
- 某些主题下可能显示不完美

### Linux
- 效果取决于窗口管理器和合成器
- 某些桌面环境可能不支持透明窗口

## 性能影响

### 优点
- 视觉效果更好
- 与设计图一致

### 缺点
- 轻微的性能开销（透明窗口合成）
- 某些低端设备可能出现卡顿

## 文件变更

### 修改的文件
1. **main.js** - 窗口配置
   - 添加 `transparent: true`
   - 添加 `backgroundColor: '#00000000'`
   - 添加 `titleBarStyle` 配置

2. **src/styles.css** - 样式调整
   - Body 添加透明背景和拖拽区域
   - Container 添加顶部内边距
   - 交互元素添加 no-drag 属性

### 新增的文件
- **docs/透明标题栏实现说明.md** - 本文档

## 测试建议

### 功能测试
1. ✅ 窗口可以正常拖拽
2. ✅ 所有按钮可以正常点击
3. ✅ 下拉选择器可以正常使用
4. ✅ 窗口控制按钮（最小化、关闭）正常工作

### 视觉测试
1. ✅ 渐变背景延伸到标题栏区域
2. ✅ 无明显的分界线
3. ✅ macOS交通灯按钮正常显示
4. ✅ 内容不被窗口控制按钮遮挡

### 平台测试
1. ✅ macOS 测试
2. ✅ Windows 测试
3. ✅ Linux 测试（可选）

## 回退方案

如果遇到问题，可以回退到非透明模式：

```javascript
// main.js
mainWindow = new BrowserWindow({
  width: 420,
  height: 680,
  resizable: false,
  // transparent: true,  // 注释掉
  backgroundColor: '#667eea',  // 使用渐变起始色
  // titleBarStyle: isMac ? 'hiddenInset' : 'default',  // 注释掉
  webPreferences: {
    nodeIntegration: false,
    contextIsolation: true,
    preload: path.join(__dirname, 'preload.js')
  }
});
```

## 未来改进

1. **自适应内边距**: 根据平台自动调整顶部内边距
2. **全屏支持**: 优化全屏模式下的显示效果
3. **主题切换**: 支持不同的背景主题
4. **性能优化**: 减少透明窗口的性能开销

---

**实现日期**: 2026-02-06
**版本**: 1.0
**基于**: docs/ui.png 设计图
